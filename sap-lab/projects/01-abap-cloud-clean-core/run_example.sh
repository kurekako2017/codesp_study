#!/bin/bash

# ABAP 程序运行结果模拟
# 由于这是 Linux 环境，无法直接运行 SAP ABAP 程序
# 此脚本模拟程序的预期输出

cat << 'EOF'
===============================================
ABAP Cloud Clean Core 示例程序 - 执行结果
===============================================

[第1步] 创建服务对象实例...
✓ 服务对象创建成功

[第2步] 添加示例产品...
✓ 产品 1 添加成功: ABAP 教科书
✓ 产品 2 添加成功: SAP 云开发
✓ 产品 3 添加成功: CDS 视图深度讲解

尝试添加无效产品 (ID 为负数):
ERROR: 产品 ID 必须大于 0
✓ 系统正确拒绝了无效数据

[第3步] 获取产品列表...
✓ 产品列表获取成功

[第4步] 统计结果:
总产品数:        3

[第5步] 产品详细列表:
-----------------------------------------------
| 编号 | 产品名称 | 价格 |
-----------------------------------------------
| 1 | ABAP 教科书 | ¥89.99 |
| 2 | SAP 云开发 | ¥129.99 |
| 3 | CDS 视图深度讲解 | ¥99.99 |
-----------------------------------------------

[完成] 程序执行成功！
===============================================

================== 执行总结 ==================

【程序流程说明】

1️⃣  对象创建
   - 使用 NEW 操作符创建 lcl_product_service 类的实例
   - lo_service 变量引用该实例

2️⃣  产品添加
   - 调用 create_product() 方法添加 3 个产品
   - 方法内部进行数据验证（ID、名称、价格）
   - 验证成功的产品被添加到内表

3️⃣  数据验证演示
   - 演示了系统如何拒绝无效数据
   - 产品 ID 为负数被系统正确拒绝
   - 错误消息清晰地提示了问题所在

4️⃣  数据检索
   - 调用 get_products() 方法获取所有产品
   - 调用 get_product_count() 方法获取产品总数

5️⃣  结果输出
   - 以表格形式展示所有产品信息
   - 包括产品编号、名称、价格等

【Clean Core 原则体现】

✓ 关注点分离
  - 业务逻辑封装在 lcl_product_service 类中
  - 报表逻辑单独在 START-OF-SELECTION 中

✓ 单一职责
  - get_products() 只负责查询
  - create_product() 只负责创建和验证
  - get_product_count() 只负责计数

✓ 易于测试
  - 可以独立创建服务对象实例进行单元测试
  - 业务逻辑与 UI 逻辑解耦

✓ 易于维护
  - 代码组织清晰，注释详细
  - 修改业务逻辑只需更改类的实现
  - 无需修改报表逻辑

【关键 ABAP 技术点】

1. 类的定义和实现 (CLASS ... DEFINITION/IMPLEMENTATION)
2. 方法定义和实现 (METHODS)
3. 参数传递 (IMPORTING/RETURNING)
4. 内表操作 (APPEND, LOOP AT)
5. 数据验证 (IF ... ENDIF)
6. 对象引用 (DATA(lo_service) = NEW ...)
7. 系统变量使用 (sy-subrc)
8. 输出语句 (WRITE)

【程序返回码】
返回码: 0 (成功)

============================================

EOF
